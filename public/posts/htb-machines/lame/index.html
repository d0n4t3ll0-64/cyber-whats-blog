<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Lame Machine Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.
Target Machine: 10.129.79.228
Enumeration sudo nmap -sV -p- --open --min-rate 5000 -n -Pn 10.129.79.228 -v -oN first_scan Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-14 07:41 -03 NSE: Loaded 46 scripts for scanning." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="//localhost:1313/posts/htb-machines/lame/" />


    <title>
        
            Lame Machine HTB :: Cyber Whats 
        
    </title>





<link rel="stylesheet" href="/main.ef20cfd98285741368a47efadf3a9e170f40b679174b7456944437335294485e.css" integrity="sha256-7yDP2YKFdBNopH763zqeFw9AtnkXS3RWlEQ3M1KUSF4=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Lame Machine HTB">
  <meta itemprop="description" content="Lame Machine Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.
Target Machine: 10.129.79.228
Enumeration sudo nmap -sV -p- --open --min-rate 5000 -n -Pn 10.129.79.228 -v -oN first_scan Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-14 07:41 -03 NSE: Loaded 46 scripts for scanning.">
  <meta itemprop="datePublished" content="2024-07-15T18:00:00+03:00">
  <meta itemprop="dateModified" content="2024-07-15T18:00:00+03:00">
  <meta itemprop="wordCount" content="1565">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Lame Machine HTB">
  <meta name="twitter:description" content="Lame Machine Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.
Target Machine: 10.129.79.228
Enumeration sudo nmap -sV -p- --open --min-rate 5000 -n -Pn 10.129.79.228 -v -oN first_scan Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-14 07:41 -03 NSE: Loaded 46 scripts for scanning.">







    <meta property="article:published_time" content="2024-07-15 18:00:00 &#43;0300 &#43;0300" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="//localhost:1313/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                Cyber WHats</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#1BDA5E;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts">Blog</a></li><li><a href="/news">Cyber News</a></li><li><a href="/tools">Tools</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        8 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="//localhost:1313/posts/htb-machines/lame/">Lame Machine HTB</a>
      </h1>

      

      

      

      <div class="post-content">
        <h2 id="lame-machine">Lame Machine</h2>
<p>Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.</p>
<hr>
<p>Target Machine: 10.129.79.228</p>
<h3 id="enumeration">Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo nmap -sV -p- --open --min-rate <span style="color:#ae81ff">5000</span> -n -Pn 10.129.79.228 -v -oN first_scan
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-07-14 07:41 -03
</span></span><span style="display:flex;"><span>NSE: Loaded <span style="color:#ae81ff">46</span> scripts <span style="color:#66d9ef">for</span> scanning.
</span></span><span style="display:flex;"><span>Initiating SYN Stealth Scan at 07:41
</span></span><span style="display:flex;"><span>Scanning 10.129.79.228 <span style="color:#f92672">[</span><span style="color:#ae81ff">65535</span> ports<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Discovered open port 139/tcp on 10.129.79.228
</span></span><span style="display:flex;"><span>Discovered open port 22/tcp on 10.129.79.228
</span></span><span style="display:flex;"><span>Discovered open port 21/tcp on 10.129.79.228
</span></span><span style="display:flex;"><span>Discovered open port 445/tcp on 10.129.79.228
</span></span><span style="display:flex;"><span>Completed SYN Stealth Scan at 07:41, 26.59s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">65535</span> total ports<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Initiating Service scan at 07:41
</span></span><span style="display:flex;"><span>Scanning <span style="color:#ae81ff">4</span> services on 10.129.79.228
</span></span><span style="display:flex;"><span>Completed Service scan at 07:42, 11.57s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span> services on <span style="color:#ae81ff">1</span> host<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>NSE: Script scanning 10.129.79.228.
</span></span><span style="display:flex;"><span>Initiating NSE at 07:42
</span></span><span style="display:flex;"><span>Completed NSE at 07:42, 0.01s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 07:42
</span></span><span style="display:flex;"><span>Completed NSE at 07:42, 0.00s elapsed
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.129.79.228
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.18s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65531</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span>21/tcp  open  ftp         vsftpd 2.3.4
</span></span><span style="display:flex;"><span>22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style="color:#f92672">(</span>workgroup: WORKGROUP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>445/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style="color:#f92672">(</span>workgroup: WORKGROUP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 38.48 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#ae81ff">131085</span> <span style="color:#f92672">(</span>5.768MB<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">18</span> <span style="color:#f92672">(</span>792B<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="open-ports">Open ports</h3>
<ul>
<li>21 - ftp vsftpd 2.3.4</li>
<li>22 - ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</li>
<li>139 - netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</li>
<li>445 - netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</li>
</ul>
<p>OS: Unix/Linux</p>
<hr>
<h3 id="scripts-scan">Scripts Scan</h3>
<p>Port 21 FTP:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> sudo nmap -sVC -p21 10.129.79.228 -v -oN script_scan_port_21
</span></span><span style="display:flex;"><span> Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-07-14 07:46 -03
</span></span><span style="display:flex;"><span> Nmap scan report <span style="color:#66d9ef">for</span> 10.129.79.228
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.18s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>21/tcp open  ftp     vsftpd 2.3.4
</span></span><span style="display:flex;"><span>|_ftp-anon: Anonymous FTP login allowed <span style="color:#f92672">(</span>FTP code 230<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ftp-syst: 
</span></span><span style="display:flex;"><span>|   STAT: 
</span></span><span style="display:flex;"><span>| FTP server status:
</span></span><span style="display:flex;"><span>|      Connected to 10.10.14.84
</span></span><span style="display:flex;"><span>|      Logged in as ftp
</span></span><span style="display:flex;"><span>|      TYPE: ASCII
</span></span><span style="display:flex;"><span>|      No session bandwidth limit
</span></span><span style="display:flex;"><span>|      Session timeout in seconds is <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>|      Control connection is plain text
</span></span><span style="display:flex;"><span>|      Data connections will be plain text
</span></span><span style="display:flex;"><span>|      vsFTPd 2.3.4 - secure, fast, stable
</span></span><span style="display:flex;"><span>|_End of status
</span></span><span style="display:flex;"><span>Service Info: OS: Unix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NSE: Script Post-scanning.
</span></span><span style="display:flex;"><span>Initiating NSE at 07:46
</span></span><span style="display:flex;"><span>Completed NSE at 07:46, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 07:46
</span></span><span style="display:flex;"><span>Completed NSE at 07:46, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 07:46
</span></span><span style="display:flex;"><span>Completed NSE at 07:46, 0.00s elapsed
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 7.58 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#ae81ff">5</span> <span style="color:#f92672">(</span>196B<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">2</span> <span style="color:#f92672">(</span>72B<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Findings:</p>
<ul>
<li>ftp-anon: Anonymous FTP login allowed (FTP code 230)</li>
<li>TYPE: ASCII</li>
<li>Control connection is plain text</li>
<li>Data connections will be plain text</li>
</ul>
<hr>
<h3 id="attempting-to-connect-to-ftp-with-anon">Attempting to connect to FTP with Anon</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> ftp anonymous@10.129.79.228
</span></span><span style="display:flex;"><span>Connected to 10.129.79.228.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 2.3.4<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">331</span> Please specify the password.
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">230</span> Login successful.
</span></span><span style="display:flex;"><span>Remote system type is UNIX.
</span></span><span style="display:flex;"><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span>ftp&gt; ls
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">229</span> Entering Extended Passive Mode <span style="color:#f92672">(||</span>|53355|<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">226</span> Directory send OK.
</span></span><span style="display:flex;"><span>ftp&gt; pwd
</span></span><span style="display:flex;"><span>Remote directory: /
</span></span><span style="display:flex;"><span>ftp&gt; ls -la
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">229</span> Entering Extended Passive Mode <span style="color:#f92672">(||</span>|41014|<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">65534</span>        <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2010</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">65534</span>        <span style="color:#ae81ff">4096</span> Mar <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2010</span> ..
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">226</span> Directory send OK.
</span></span></code></pre></div><p>Findings: it doesn&rsquo;t seems like there is something here</p>
<hr>
<p>Port 139 Samba:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo nmap -sVC -p139 10.129.79.228 -v -oN script_scan_port_139
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-07-14 07:57 -03
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.129.79.228
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.18s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span>139/tcp open  netbios-ssn Samba smbd 3.0.20-Debian <span style="color:#f92672">(</span>workgroup: WORKGROUP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb-os-discovery: 
</span></span><span style="display:flex;"><span>|   OS: Unix <span style="color:#f92672">(</span>Samba 3.0.20-Debian<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   Computer name: lame
</span></span><span style="display:flex;"><span>|   NetBIOS computer name: 
</span></span><span style="display:flex;"><span>|   Domain name: hackthebox.gr
</span></span><span style="display:flex;"><span>|   FQDN: lame.hackthebox.gr
</span></span><span style="display:flex;"><span>|_  System time: 2024-07-13T06:58:33-04:00
</span></span><span style="display:flex;"><span>|_clock-skew: mean: -21h59m28s, deviation: 2h49m45s, median: -23h59m31s
</span></span><span style="display:flex;"><span>|_smb2-time: Protocol negotiation failed <span style="color:#f92672">(</span>SMB2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| smb-security-mode: 
</span></span><span style="display:flex;"><span>|   account_used: guest
</span></span><span style="display:flex;"><span>|   authentication_level: user
</span></span><span style="display:flex;"><span>|   challenge_response: supported
</span></span><span style="display:flex;"><span>|_  message_signing: disabled <span style="color:#f92672">(</span>dangerous, but default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NSE: Script Post-scanning.
</span></span><span style="display:flex;"><span>Initiating NSE at 07:58
</span></span><span style="display:flex;"><span>Completed NSE at 07:58, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 07:58
</span></span><span style="display:flex;"><span>Completed NSE at 07:58, 0.00s elapsed
</span></span><span style="display:flex;"><span>Initiating NSE at 07:58
</span></span><span style="display:flex;"><span>Completed NSE at 07:58, 0.00s elapsed
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 52.48 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#ae81ff">5</span> <span style="color:#f92672">(</span>196B<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">2</span> <span style="color:#f92672">(</span>72B<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="gathering-info-from-smbclient">Gathering Info from SMBclient</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>smbclient -N -L //10.129.79.228/
</span></span><span style="display:flex;"><span>Anonymous login successful
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Sharename       Type      Comment
</span></span><span style="display:flex;"><span> ---------       ----      -------
</span></span><span style="display:flex;"><span> print$          Disk      Printer Drivers
</span></span><span style="display:flex;"><span> tmp             Disk      oh noes!
</span></span><span style="display:flex;"><span> opt             Disk      
</span></span><span style="display:flex;"><span> IPC$            IPC       IPC Service <span style="color:#f92672">(</span>lame server <span style="color:#f92672">(</span>Samba 3.0.20-Debian<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span> ADMIN$          IPC       IPC Service <span style="color:#f92672">(</span>lame server <span style="color:#f92672">(</span>Samba 3.0.20-Debian<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>Reconnecting with SMB1 <span style="color:#66d9ef">for</span> workgroup listing.
</span></span><span style="display:flex;"><span>Anonymous login successful
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Server               Comment
</span></span><span style="display:flex;"><span> ---------            -------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Workgroup            Master
</span></span><span style="display:flex;"><span> ---------            -------
</span></span><span style="display:flex;"><span> WORKGROUP            LAME
</span></span></code></pre></div><h3 id="accessing-tmp-shared-directory">Accessing TMP shared directory</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>smbclient -N //10.129.79.228/tmp
</span></span><span style="display:flex;"><span>Anonymous login successful
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">13</span> 08:07:43 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  ..                                 DR        <span style="color:#ae81ff">0</span>  Sat Oct <span style="color:#ae81ff">31</span> 03:33:58 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  .ICE-unix                          DH        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:38:17 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  vmware-root                        DR        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:39:06 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  .X11-unix                          DH        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:38:42 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  .X0-lock                           HR       <span style="color:#ae81ff">11</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:38:42 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  5643.jsvc_up                        R        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:39:28 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  vgauthsvclog.txt.0                  R     <span style="color:#ae81ff">1600</span>  Sat Jul <span style="color:#ae81ff">13</span> 07:38:15 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">7282168</span> blocks of size 1024. <span style="color:#ae81ff">5385916</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> 
</span></span></code></pre></div><h3 id="listing-tmp">Listing tmp</h3>
<ul>
<li>.ICE-unix - nothing</li>
<li>vmware-root - /tmp/smbmore.8d4WVi</li>
<li>.X11-unix - X0 - /tmp/smbmore.IhQwnG</li>
<li>.X0-lock - 5704 (a pass maybe ?)</li>
<li>vgauthsvclog.txt.0</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.387<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> VGAuthService <span style="color:#e6db74">&#39;build-4448496&#39;</span> logging at level <span style="color:#e6db74">&#39;normal&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.387<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Pref_LogAllEntries: <span style="color:#ae81ff">1</span> preference groups in file <span style="color:#e6db74">&#39;/etc/vmware-tools/vgauth.conf&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.387<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Group <span style="color:#e6db74">&#39;service&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.387<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span>         samlSchemaDir<span style="color:#f92672">=</span>/usr/lib/vmware-vgauth/schemas
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.387<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Pref_LogAllEntries: End of preferences
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> VGAuthService <span style="color:#e6db74">&#39;build-4448496&#39;</span> logging at level <span style="color:#e6db74">&#39;normal&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Pref_LogAllEntries: <span style="color:#ae81ff">1</span> preference groups in file <span style="color:#e6db74">&#39;/etc/vmware-tools/vgauth.conf&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Group <span style="color:#e6db74">&#39;service&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span>         samlSchemaDir<span style="color:#f92672">=</span>/usr/lib/vmware-vgauth/schemas
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Pref_LogAllEntries: End of preferences
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Cannot load message catalog <span style="color:#66d9ef">for</span> domain <span style="color:#e6db74">&#39;VGAuthService&#39;</span>, language <span style="color:#e6db74">&#39;C&#39;</span>, catalog dir <span style="color:#e6db74">&#39;.&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> INIT SERVICE
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.462<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> Using <span style="color:#e6db74">&#39;/var/lib/vmware/VGAuth/aliasStore&#39;</span> <span style="color:#66d9ef">for</span> alias store root directory
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.492<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> SAMLCreateAndPopulateGrammarPool: Using <span style="color:#e6db74">&#39;/usr/lib/vmware-vgauth/schemas&#39;</span> <span style="color:#66d9ef">for</span> SAML schemas
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.522<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> SAML_Init: Allowing <span style="color:#ae81ff">300</span> of clock skew <span style="color:#66d9ef">for</span> SAML date validation
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Jul <span style="color:#ae81ff">13</span> 06:38:15.522<span style="color:#f92672">]</span> <span style="color:#f92672">[</span> message<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>VGAuthService<span style="color:#f92672">]</span> BEGIN SERVICE
</span></span></code></pre></div><hr>
<h3 id="metasploit">Metasploit</h3>
<p>I didn&rsquo;t find anything interesting accessing smbclient, so i search for any exploit for the Samba version 3.0.20 and found there is one exploit that works with this version:
Samba &ldquo;username map script&rdquo; Command Execution</p>
<p>The next move was to initiate msfconsole and search for samba

    <img src="/img/lame-machine/1.png"  alt="first image"  class="center"  style="border-radius: 8px;"  />


Then we need to set the RHOST(target machine) and the LHOST(our machine)
in order to get a reverse shell with root privileges (as root user)</p>

    <img src="/img/lame-machine/2.png"  alt="first image"  class="center"  style="border-radius: 8px;"  />


<p>Once all is setup we can run the exploit</p>

    <img src="/img/lame-machine/3.png"  alt="first image"  class="center"  style="border-radius: 8px;"  />


<p>Then to get the root flag just cd to the root user home folder (/root)
and run the ls command to get the root.txt</p>

    <img src="/img/lame-machine/4.png"  alt="first image"  class="left"  style="border-radius: 8px;"  />


<p>Congratulations! we pwnd the root flag! Let&rsquo;s get the User flag
In order to get the user flag we need to know what users the machine have, for that we have to move to the /etc/ directory and cat the /etc/passwd to see what&rsquo;s the user name .</p>
<p>
    <img src="/img/lame-machine/5.png"  alt="first image"  class="center"  style="border-radius: 8px;"  />



    <img src="/img/lame-machine/6.png"  alt="first image"  class="center"  style="border-radius: 8px;"  />

</p>
<p>Also we can get the id_dsa file to connect via SSH but as we are the root user we can switch to this user using su makis in order to access his/her files.</p>

    <img src="/img/lame-machine/7.png"  alt="first image"  class="left"  style="border-radius: 8px;"  />


<p>As we were at the /etc/ directory we simply type cd to move to the home folder and list all files.</p>

    <img src="/img/lame-machine/8.png"  alt="first image"  class="left"  style="border-radius: 8px;"  />


<p>We find an intriguing file&hellip; let&rsquo;s cat it

    <img src="/img/lame-machine/9.png"  alt="first image"  class="left"  style="border-radius: 8px;"  />

</p>
<p>There we go!! The last flag was found !!
Congratulation to made it this far, Lame machine from HTB was Pwnd!!</p>
<hr>
<h2 id="final-thoughts">Final thoughts</h2>
<p>I&rsquo;ve tried to use the id_dsa key i found in the .ssh directory , but was useless. This was the message i got everytime</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>❯ sudo ssh makis@10.129.79.228 -i id_dsa
</span></span><span style="display:flex;"><span>Unable to negotiate with 10.129.79.228 port 22: no matching host key type found. Their offer: ssh-rsa,ssh-dss
</span></span></code></pre></div><p>So i do a little research about this key and it seems to be and old one and to make it work was a pain in the ass.
Therefore I&rsquo;ve tried to create while being in the machine as the root user an id_rsa key but as i was the root user the key was for that specific user.. changing to makis wasn&rsquo;t and option bc i didn&rsquo;t know the password for the sudo command&hellip; of course as we are root we can go to the /etc/shadow file and get the hash for the makis password and try to crack it with john the ripper&hellip;But as long for this machine wasn&rsquo;t necessary because we already had access to the makis directory and pwnd the flag..
It was fun to made all this research, i got lot of new knowledge tough.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1565 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2024-07-15 12:00
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="//localhost:1313/posts/htb-machines/nibbles/">
                    <span class="button__text">Nibbles Machine HTB</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="//localhost:1313/"></a></span>
            <span></span>
            <span><a href="//localhost:1313/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js" integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script>




    </body>
</html>
